{ 
  "rules": {
    "admin": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true"
    },
    "kontaktreg": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$teach": {
         "$date":{
            "$reg": {
              "$count": {
                "$uid": {
                  ".write":"root.child('userid').child(auth.uid).val() === $uid && root.child('teach').child($teach).exists() === true  && root.child('idag').val() === $date && $count.matches(/[0-9A-F]+/) && root.child('regkeys').child($reg).child('count').val() > $count"
                }
              }
            }
         }
      }
    },
    "registrert": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$date":{
         "$reg" : {
           "$uid": {
              ".write":"root.child('regkeys').child($reg).exists() === true && root.child('idag').val() === $date && root.child('userid').child(auth.uid).val() === $uid"
           }
         }
      }
    },
    "studreg": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      ".validate": "newData.child('timestamp').val() > (now-600000)"
    },
    "userid": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$uid": {
          ".read": "auth.uid === $uid",
          ".write": "auth.uid === $uid"
      }
    },
    "teachid": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$uid": {
          ".read": "auth.uid === $uid",
          ".write": "auth.uid === $uid"
      }
    },
    "rooms": {
      ".read": "auth.uid != null"
    },  
    "teach": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$uid": {
          ".read": "auth.uid === $uid",
          ".write": "auth.uid === $uid"
      }
    },
    "onetime": {
        "$otp": {
          ".read": "$otp !== 2"
        }     
    },     
    "regkeys": {
       ".read": "root.child('teachid').child(auth.uid).exists() === true", 
       "$key": {
         ".read": "$key !== 2",
         ".write": "root.child('teachid').child(auth.uid).exists() === true"
       }
    }, 
     "stud": {
      ".read": "root.child('teachid').child(auth.uid).exists() === true",
      "$uid": {
        ".read":"$uid !== 2",
        "userid": {
          ".write": "!data.exists()"
        }
      }
    }

  }
}